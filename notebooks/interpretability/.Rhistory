library(clusterProfiler)
library(org.Hs.eg.db)
library(ggplot2)
library(reticulate)
py_install('pandas','scikit-klearn')
reticulate::repl_python()
library(reticulate)
py_install('pandas','scikit-klearn')
use_python("C:/Users/rayan/AppData/Local/Programs/Python/Python311/python.exe",
required = TRUE)
py_install('pandas')
py_require(c("pandas"))
py_require(c("scikit-learn"))
reticulate::repl_python()
py_require(c("GEOparse"))
reticulate::repl_python()
head(df_raw)
reticulate::repl_python()
# -- i wanna retrieve a variable from python env (df_raw to R)
df_raw = py$df_raw
head(df_raw)
df_raw = as.data.frame(py$df_raw)
head(df_raw)
df_raw
df_raw.iloc[:,5:] # -- showing the embeddings columns
# trandsform to dataframe
df_raw = as.data.frame(df_raw)
View(df_raw)
head(df_raw)
embedding_num=140
col=paste0('emb_',embedding_num)
col
gene_list=df_raw[,col]
gene_list
# -- soring based on col
df_sorted=df_raw[order(-abs(df_raw[[col]])),]
df_sorted[1:5, c(col,ncol(df_sorted))]
df_sorted[, col]
# -- soring based on col
df_sorted=df_raw[order(df_raw[[col]]),]
df_sorted[, col]
# -- soring based on col
df_sorted=df_raw[order(df_raw[[col],desc]),]
# -- soring based on col
df_sorted=df_raw[order(df_raw[[col]],desc),]
# -- soring based on col
df_sorted=df_raw[order(df_raw[[col]],"desc"),]
# -- soring based on col
df_sorted=df_raw[desc(order(df_raw[[col]])),]
View(df_raw)
# -- soring based on col
df_sorted <- df_raw[order(df_raw[[col]], decreasing = TRUE), ]
df_sorted[, col]
# -- soring based on col
df_sorted <- df_raw[order(df_raw[[col]], decreasing = TRUE), ]
# -- fa
gene_list <- df_sorted[[col]]
names(gene_list) <- rownames(df_sorted)
head(gene_list)
# -- GSEA KEGG
gsea_kegg <- gseKEGG(geneList     = gene_list,
organism     = 'hsa',
nPerm        = 1000,
minGSSize    = 10,
maxGSSize    = 500,
pvalueCutoff = 0.05,
verbose      = TRUE
)
gene_df <- bitr(
names(gene_list),
fromType = "SYMBOL",
toType   = "ENTREZID",
OrgDb    = org.Hs.eg.db
)
gene_list_entrez <- gene_list[gene_df$SYMBOL]
names(gene_list_entrez) <- gene_df$ENTREZID
gene_list_entrez <- sort(gene_list_entrez, decreasing = TRUE)
View(gene_df)
gsea_kegg <- gseKEGG(
geneList     = gene_list_entrez,
organism     = "hsa",
minGSSize    = 10,
pvalueCutoff = 0.05
)
gsea_kegg
dotplot(gsea_kegg, showCategory=20) + ggtitle("GSEA KEGG Pathways")
if (!requireNamespace("clusterProfiler", quietly = TRUE) || !requireNamespace("org.Hs.eg.db", quietly = TRUE)||
!requireNamespace("enrichplot", quietly = TRUE))
BiocManager::install(c("clusterProfiler",'org.Hs.eg.db','enrichplot'))
library(enrichplot)
dotplot(gsea_kegg)
dotplot(gsea_kegg, showCategory=20, title=paste0("GSEA KEGG pathways - Embedding ",embedding_num))
gsea_kegg <- gseKEGG(
geneList     = gene_list_entrez,
organism     = "hsa",
pvalueCutoff = 0.05
)
gsea_kegg <- gseKEGG(
geneList     = gene_list_entrez,
organism     = "hsa",
pvalueCutoff = 0.05
)
gsea_kegg
gsea_kegg <- gseKEGG(
geneList     = gene_list_entrez,
organism     = "hsa",
pvalueCutoff = 0.5
)
gsea_kegg <- gseKEGG(
geneList     = gene_list_entrez,
organism     = "hsa",
pvalueCutoff = 0.5
)
gsea_kegg
dotplot(gsea_kegg, showCategory=20, title=paste0("GSEA KEGG pathways - Embedding ",embedding_num))
embedding_num=127
col=paste0('emb_',embedding_num)
# -- soring based on col
df_sorted <- df_raw[order(df_raw[[col]], decreasing = TRUE), ]
# -- fa
gene_list <- df_sorted[[col]]
names(gene_list) <- rownames(df_sorted)
head(gene_list)
gene_df <- bitr(
names(gene_list),
fromType = "SYMBOL",
toType   = "ENTREZID",
OrgDb    = org.Hs.eg.db
)
gene_list_entrez <- gene_list[gene_df$SYMBOL]
names(gene_list_entrez) <- gene_df$ENTREZID
gene_list_entrez <- sort(gene_list_entrez, decreasing = TRUE)
gsea_kegg <- gseKEGG(
geneList     = gene_list_entrez,
organism     = "hsa",
pvalueCutoff = 0.5
)
gsea_kegg
dotplot(gsea_kegg, showCategory=20, title=paste0("GSEA KEGG pathways - Embedding ",embedding_num))
gene_df <- bitr(
names(gene_list),
fromType = "SYMBOL",
toType   = "ENTREZID",
OrgDb    = org.Hs.eg.db
)
gene_list_entrez <- gene_list[gene_df$SYMBOL]
names(gene_list_entrez) <- gene_df$ENTREZID
gene_list_entrez <- sort(gene_list_entrez, decreasing = TRUE)
gsea_kegg <- gseKEGG(
geneList     = gene_list_entrez,
organism     = "hsa",
pvalueCutoff = 0.05
)
gsea_kegg
dotplot(gsea_kegg, showCategory=20, title=paste0("GSEA KEGG pathways - Embedding ",embedding_num))
gsea_kegg@result
View(gsea_kegg@result)
